{% extends "base.html" %}
{% block content %}
<div class="container mt-4"><h2>Analiza</h2>
<div class="row">
  {% for a in analysis %}
  <div class="col-md-4 mb-4">
    <div class="card p-3">
      <h5>{{a.dish}}</h5>
      <p>Food cost: {{'%.2f'|format(a.cost)}}</p>
      <p>%: {{'%.1f'|format(a.pct)}}</p>
    </div>
  </div>
  {% endfor %}
</div>
<div class="card p-3 mb-4"><canvas id="barChart"></canvas></div>
<div class="card p-3"><canvas id="pieChart"></canvas></div>
</div>
{% endblock %}
{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const data = {{ analysis|tojson }};
const labels = data.map(d=>d.dish);
const costs = data.map(d=>d.cost);
const pcts = data.map(d=>d.pct);
// bar chart
new Chart(document.getElementById('barChart'), {type:'bar',data:{labels, datasets:[{label:'Food Cost',data:costs}]}});
// pie
new Chart(document.getElementById('pieChart'), {type:'pie',data:{labels, datasets:[{data:pcts}]}});
</script>
{% endblock %}