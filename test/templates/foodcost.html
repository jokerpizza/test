{% extends "base.html" %}
{% block head %}
<style>
  /* Highlight dish row in red if FC% > 30% */
  .fc-high { background-color: rgba(220,53,69,0.2); }
</style>
{% endblock %}
{% block content %}
<ul class="nav nav-pills mb-4">
  <li class="nav-item"><a class="nav-link {% if tab=='products' %}active{% endif %}" href="{{ url_for('foodcost', tab='products') }}">Produkty</a></li>
  <li class="nav-item"><a class="nav-link {% if tab=='dishes' %}active{% endif %}" href="{{ url_for('foodcost', tab='dishes') }}">Dania</a></li>
  <li class="nav-item"><a class="nav-link {% if tab=='analysis' %}active{% endif %}" href="{{ url_for('foodcost', tab='analysis') }}">Analiza</a></li>
</ul>

{% if tab=='products' %}
<!-- ... (unchanged products tab) ... -->
{% elif tab=='dishes' %}
<div class="fc-card">
  <h4>Dania</h4>
  <form action="{{ url_for('add_dish') }}" method="POST" class="mb-4">
    <!-- dish form unchanged -->
  </form>
  <table class="table table-dark table-striped">
    <thead><tr><th>Nazwa</th><th>Cena</th><th>Food Cost %</th></tr></thead>
    <tbody>
      {% for d in dishes %}
      {% set cost = d.recipe|sum(attribute='cost') %}
      {% set fc_pct = (cost / d.sale_price) * 100 if d.sale_price else 0 %}
      <tr class="{% if fc_pct > 30 %}fc-high{% endif %}">
        <td>{{ d.name }}</td>
        <td>{{ '%.2f'|format(d.sale_price) }}</td>
        <td>{{ '%.1f'|format(fc_pct) }}%</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% elif tab=='analysis' %}
<div class="fc-card">
  <h4>Analiza Koszt√≥w</h4>
  <!-- analysis chart unchanged -->
</div>
{% endif %}
{% endblock %}
{% block scripts %}
<!-- existing scripts -->
{% endblock %}
