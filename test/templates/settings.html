{% extends "base.html" %}
{% block content %}
<h2>Ustawienia kategorii kosztów</h2>

<h3>Kategorie główne</h3>
<form method="post" class="mb-3">
    <input type="hidden" name="action" value="add_main">
    <input type="text" name="main_name" placeholder="Nowa kategoria główna" required class="form-control d-inline-block w-auto">
    <button type="submit" class="btn btn-primary">Dodaj kategorię</button>
</form>

<table class="table">
    <thead><tr><th>Kategoria główna</th><th>Akcje</th></tr></thead>
    <tbody>
    {% for mc in main_categories %}
      <tr>
        <td>{{ mc.name }}</td>
        <td>
            <form method="post" style="display:inline;">
                <input type="hidden" name="action" value="delete_main">
                <input type="hidden" name="main_id" value="{{ mc.id }}">
                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Usunąć kategorię główną i wszystkie podkategorie?')">Usuń</button>
            </form>
        </td>
      </tr>
      <tr>
        <td colspan="2">
          <strong>Podkategorie:</strong>
          <ul>
            {% for sc in mc.subcategories %}
            <li>
              {{ sc.name }}
              <form method="post" style="display:inline;">
                <input type="hidden" name="action" value="delete_sub">
                <input type="hidden" name="sub_id" value="{{ sc.id }}">
                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Usunąć podkategorię?')">Usuń</button>
              </form>
            </li>
            {% endfor %}
          </ul>
          <form method="post">
            <input type="hidden" name="action" value="add_sub">
            <input type="hidden" name="parent_id" value="{{ mc.id }}">
            <input type="text" name="sub_name" placeholder="Nowa podkategoria" required class="form-control d-inline-block w-auto">
            <button type="submit" class="btn btn-secondary btn-sm">Dodaj podkategorię</button>
          </form>
        </td>
      </tr>
    {% endfor %}
    </tbody>
</table>
{% endblock %}